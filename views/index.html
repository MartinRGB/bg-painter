<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
	    <meta name="format-detection" content="telephone=no"/>
	    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
     	<script src="./libs/lottie_light.min.js"></script>
     	<script src="./libs/jquery.min.js"></script>

		<title>Bg Painter</title>
		<style type="text/css">
			* {
				margin: 0;
				padding: 0;
				font-family: 'Helvetica Neue', sans-serif;
				box-sizing: border-box;
			}

			html {
				height: 100%;
			}

			body {
				background-color: #000009;
				margin: 0px;
				height: 100%;
				color: #555;
				/*overflow: hidden;*/
			}

			.wrapper {
				position: relative;
				margin: 0 auto;
				width: 900px;
				font-size: 0;
			}


			.header {
				position: relative;
				width: 100%;
				color: #fff;
				background-color: #000009;
				font-size: 32px;
				font-weight: 100;
				font-family: 'Helvetica Neue';
				text-align: left;
			}
			.header .logo-wrapper {
				display: inline-block;
				vertical-align: top;
				width: 30%
			}
			.header .logo {
				display: inline-block;
				vertical-align: middle;
				margin: 14px 0px;
				margin-right: 4px;
				width: 38px;
				height: 38px;
				background-image: url(images/logo.png);
				background-size: cover;
			}
			.header .logotype {
				display: inline-block;
				vertical-align: middle;
				width: 110px;
				height: 55px;

				transition: 800ms ease;
				opacity: 0.0;
			}
			.header .menu-wrapper {
				display: inline-block;
				vertical-align: top;
				width: 70%;
				text-align: right;
			}
			.header .menu-item {
				display: inline-block;
				vertical-align: top;
				width: 100px;
				height: 66px;
			}
			.header .menu-item .lan-btn {
				display: inline-block;
				vertical-align: top;
				margin-top: 16px;
				width: 40px;
				height: 32px;
				background-color: rgba(255,255,255,0.05);
				opacity: 0.3;
				cursor: pointer;
			}
			.header .menu-item .lan-btn.on {
				background-color: #2c273a;
				opacity: 1.0;
			}
			.header .menu-item .lan-btn.zh {
				border-top-left-radius: 6px;
				border-bottom-left-radius: 6px;
				background-image: url(images/ui/switch_lan_zh.png);
			}
			.header .menu-item .lan-btn.en {
				border-top-right-radius: 6px;
				border-bottom-right-radius: 6px;
				background-image: url(images/ui/switch_lan_en.png);
			}


			.footer {
				position: relative;
				padding-right: 40px;
				width: 100%;
				height: 60px;
				background-color: #000;
				text-align: right;
				z-index: 999;
			}
			.footer a {
				color: #777;
				text-decoration: underline;
				line-height: 60px;
				text-align: right;
			}

			h2 {
				font-size: 20px;
				font-weight: normal;
			}

			a {
				color: #000;
				text-decoration: none;
			}

			/* view */
			#viewer {
				position: relative;
				margin: 0 auto;
				width: 100%;
				overflow: auto;
			}
			#painterview {
				width: 100%;
				height: 0;
				border: none;
				overflow: hidden;
			}
			
			/* gallery */
			#gallery {
				position: relative;
				margin: 0 auto;
				width: 900px;
				text-align: left;
			}

			#gallery h4 {
				/*padding: 60px 0 0;*/
				color: rgba( 255,255,255, 0.6 );
				font-size: 20px;
				font-weight: 100;
				line-height: 32px;
				letter-spacing: 1.4px;
				text-align: center;
			}
			#gallery .deco-line {
				position: relative;
				margin: 40px auto 20px;
				width: 100%;
				height: 1px;
				background-color: rgba( 255,255,255,0.1);
			}

			.link {
				display: inline-block;
				vertical-align: top;
				margin: 27px 33px 24px 0;
				width: 200px;
			}
			.link:nth-child(4n+0) {
				margin-right: 0;
			}
			.link-img {
				width: 200px; height: 100px;
				border-radius: 7px;
				overflow: hidden;
			}
			.link-name {
				color: rgba(220,220,220,0.97);
				font-size: 10px;
				font-weight: 200;
				font-style: italic;
				letter-spacing: 1px;
				line-height: 32px;
				text-align: center;
			}
		</style>
		<script>
			var _hmt = _hmt || [];
			(function() {
			  var hm = document.createElement("script");
			  hm.src = "https://hm.baidu.com/hm.js?d84d162ea3122a700428736747a85ce0";
			  var s = document.getElementsByTagName("script")[0]; 
			  s.parentNode.insertBefore(hm, s);
			})();
		</script>
	</head>
<body>
	<div class="header">
		<div class="wrapper">
			<div class="logo-wrapper">
				<div class="logo"></div>
				<div class="logotype" id="logo_anim"></div>
			</div>
			<div class="menu-wrapper">
				<div class="menu-item" id="switch_language">
					<div class="lan-btn zh" data-lang="zh">中</div>
					<div class="lan-btn en" data-lang="en">EN</div>
				</div>
			</div>
		</div>
	</div>

	<!-- main view -->
	<section id="viewer">
		<iframe id="painterview" 
				src="./paints/LiquidsChromatic.html" 
				name="painterview" 
				onload="setIframeInfo()" 
				frameborder="0" 
				scrolling="no" 
				allowfullscreen 
				allowvr 
				onmousewheel="">
		</iframe>
	</section>

	<!-- gallery list -->
	<section id="gallery">
		<div class="deco-line"></div>
		<h4></h4>
		<div id="content"></div>
	</section>

	<!-- footer -->
	<div class="footer">Made by <a href="http://www.fangyexu.com" target="blank">Fangye X</a></div>

	<script src="paints.js"></script>
	<script type="text/javascript">

		// 设定语言显示
		// ------------------------------------------------------------
		var words = {
			'#gallery h4' : {
				en: 'Find more wonderful paints',
				zh: '发现更多样式'
			},
			"#tip_resetPattern": {
				en: "Refresh pattern",
				zh: "刷新样式"
			},
			"#tip_shuffleTheme": {
				en: "Shuffle theme",
				zh: "切换颜色主题"
			}
		}

		if( localStorage.hasOwnProperty('lang') ) {

		}else{
			var language=null;
			if (navigator.appName == 'Netscape'){
				language = navigator.language;
			}
			else{
				language = navigator.browserLanguage;
			}
			if (language.indexOf('en') > -1){
				localStorage.lang = "en"
			} 
			else if (language.indexOf('zh') > -1){
				localStorage.lang = "zh"
			} 
			else{
				localStorage.lang = "en"
			}
		}


		function switchLanguage( lang ) {
			localStorage.lang = lang;

			switch( lang ) {
				case 'en':
					$('.lan-btn.en').addClass('on');
					$('.lan-btn.en').siblings().removeClass('on');
					for( var key in paints ) {
						$( '#' + key + ' .link-name' ).html( paints[key].name );
					}
					break;
				case 'zh':
					$('.lan-btn.zh').addClass('on');
					$('.lan-btn.zh').siblings().removeClass('on');
					for( var key in paints ) {
						$( '#' + key + ' .link-name' ).html( paints[key].nameZh );
					}
					break;
			}

			// UI话术 区分中英文
			for( var key in words ) {
				$(key).html( words[key][lang] );
			}

			// 当前的paint，标题区分中英文
			CurrentPaintInfo.title = localStorage.lang === 'zh'? CurrentPaintInfo.nameZh : CurrentPaintInfo.name;
			if( painterview.window.document.getElementById('info_title') ) {
				painterview.window.document.getElementById('info_title').textContent = CurrentPaintInfo.title;
			}
		}

		$('.lan-btn').click(function(e){
			if( this.dataset.lang === 'zh' ) {
				switchLanguage('zh');
			}else{
				switchLanguage('en');
			}
		})



		// style setting
		var screenWidth = window.innerWidth;
		var iframeHeight = screenWidth > 1400 ? 720 : 600;
		var pview = document.getElementById('painterview');
		pview.style.height = iframeHeight + 'px';



		// 创建一个对象，用来封装当前选中的paint的信息
		var paint = paints['LiquidsChromatic'];

		var CurrentPaintInfo = {};
		CurrentPaintInfo.title = localStorage.lang === 'zh'? paint.nameZh : paint.name;
		CurrentPaintInfo.name = paint.name;
		CurrentPaintInfo.nameZh = paint.nameZh;
		CurrentPaintInfo.tags = ['colorful','flowing','chromatic']


		for ( var key in paints ) {

			var item = paints[key];

			var linkItem = document.createElement('a');
			linkItem.className = 'link';
			linkItem.href = './paints/' + item.url;
			linkItem.setAttribute( 'target', 'painterview' ); // 点击后切换至对应的iframe
			linkItem.setAttribute( 'name', item.name );
			linkItem.setAttribute( 'id', key );
			linkItem.addEventListener( 'click', function(event){
				painterview.window.location.reload();
				var id = event.currentTarget.id;
				var targetItem = paints[ id ];
				CurrentPaintInfo.title = localStorage.lang === 'zh'? targetItem.nameZh : targetItem.name;
				CurrentPaintInfo.name = targetItem.name;
				CurrentPaintInfo.nameZh = targetItem.nameZh;
				CurrentPaintInfo.tags = targetItem.tags;
			},false);

			var img = document.createElement('img');
			img.src = item.picurl;
			img.setAttribute('width','100%');
			var imgwrapper = document.createElement('div');
			imgwrapper.className = 'link-img';
			imgwrapper.appendChild(img);

			var paintName = document.createElement('div');
			paintName.textContent = item.name;
			paintName.className = 'link-name';

			linkItem.appendChild(imgwrapper);
			linkItem.appendChild(paintName);

			$('#content').append(linkItem);
		}

		function setIframeInfo() {
			painterview.window.document.title = CurrentPaintInfo.title;
			painterview.window.document.getElementById('keywords').content = CurrentPaintInfo.tags;
			switchLanguage( localStorage.lang );
		}

		function selectFile(file) {

			window.location.hash = file;
			painterview.focus();
			painterview.src = file + '.html';

			selected = file;

		}

		// Logotype animation
		// ------------------------------------------------------------
	    var animData = {
	        wrapper: document.getElementById('logo_anim'),
	        renderer: 'svg',
	        // animType: 'html',
	        loop: false,
	        prerender: true,
	        autoplay: false,
	        path: './images/logotype.json'

	    };
	    var anim = bodymovin.loadAnimation(animData);
	    anim.setSpeed(2.0);
	    var t = setTimeout(function(){
	    	anim.play();
	    	logo_anim.style.opacity = 1.0;
	    }, 100);





	</script>
</body>
</html>